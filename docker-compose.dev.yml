services:
  tenshi:
    build:
      context: .
    container_name: tenshi
    hostname: tenshi
    environment:
      - PASSWORD=${TENSHI_PASSWORD:?error}
      - VNC_PASSWORD=${TENSHI_VNC_PASSWORD:?error}
      # - DEBUG_OPENCV=1
    ports:
      # FastAPI
      - "6081:8000"
      # Browser remote debugging port  
      - "6082:9222"
      # DEBUG Purposes:
      - "6080:6080" # noVNC HTML5 interface (access via browser)â€”noVNC Connection endpoint http://<IPv4>:6080/vnc.html
      - "5900:5900" # raw VNC (optional)
    volumes:
      - /dev/shm:/dev/shm # Shared memory
      - /run/dbus/system_bus_socket:/host/run/dbus/system_bus_socket
      - ./docker/data:/tenshi/data # Data Output
    cap_add:
      - SYS_PTRACE
    restart: on-failure
    networks:
      - proxy

networks:
  proxy:
    driver: bridge
    external: true
